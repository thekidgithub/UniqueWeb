(()=>{const e=document.querySelector(".input"),t=document.querySelector(".seleteall"),d=document.querySelector(".todolist"),s=new class{constructor(){this.todos=[],this.undone=0,this.done=0,this.mode=1}add(e){this.todos.push({text:e,done:0}),this.undone++}remove(e){this.todos.splice(e,1)}removeDone(){this.todos=this.todos.filter(((e,t)=>0===e.done)),this.done=0}checkAll(){const e=document.querySelectorAll(".check"),t=document.querySelectorAll(".todo");e.forEach((e=>e.innerHTML="√")),t.forEach(((e,t)=>{e.classList.add("checked"),this.todos[t].done=1,this.done++,this.undone--}))}uncheckAll(){const e=document.querySelectorAll(".check"),t=document.querySelectorAll(".todo");e.forEach((e=>e.innerHTML="")),t.forEach(((e,t)=>{e.classList.remove("checked"),this.todos[t].done=0,this.done--,this.undone++}))}displayBottom(){const e=document.createElement("div"),t=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div");e.classList.add("bottom"),t.classList.add("left"),s.classList.add("changemode"),o.classList.add("clear"),t.innerHTML=this.undone+"items left";for(let e=1;e<=3;e++){const t=document.createElement("div");switch(t.classList.add("mode"),e){case 1:t.innerHTML="All";break;case 2:t.innerHTML="Active";break;case 3:t.innerHTML="Completed"}s.appendChild(t)}s.childNodes[this.mode-1].classList.add("seleted"),o.innerHTML="Clear Completed",e.appendChild(t),e.appendChild(s),e.appendChild(o),o.addEventListener("click",(()=>{this.removeDone(),this.displaySwitch(),this.updBottom()})),d.appendChild(e),this.updBottom()}updBottom(){const e=document.querySelector(".left"),t=document.querySelector(".clear");document.querySelectorAll(".mode").forEach(((e,t)=>{e.addEventListener("click",(()=>{switch(t){case 0:this.mode=1;break;case 1:this.mode=2;break;case 2:this.mode=3}this.displaySwitch()}))})),e.innerHTML=this.undone+"items left",this.done>0?t.classList.add("show"):t.classList.remove("show")}displaySwitch(){d.innerHTML="",this.todos.forEach(((e,t)=>{const s=document.createElement("li"),o=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div");switch(s.classList.add("todo"),o.classList.add("check"),n.classList.add("text"),i.classList.add("close"),e.done&&(s.classList.add("checked"),o.innerHTML="√"),n.innerHTML=e.text,i.innerHTML="X",o.addEventListener("click",(()=>{e.done=1===e.done?0:1,s.classList.toggle("checked"),o.innerHTML=e.done?"√":"",this.done=e.done?this.done+1:this.done-1,this.undone=e.done?this.undone-1:this.undone+1,this.updBottom()})),n.addEventListener("dblclick",(d=>{d.preventDefault();const s=document.createElement("input");s.classList.add("inputabove"),s.value=n.innerHTML,s.addEventListener("keyup",(d=>{"Enter"==d.key&&(""!=d.target.value.trim()?(n.innerHTML=d.target.value,s.remove()):(e.done?this.done--:this.undone--,this.remove(t),this.displaySwitch(),this.updBottom()))})),n.appendChild(s),s.focus()})),i.addEventListener("click",(()=>{e.done?this.done--:this.undone--,this.remove(t),this.displaySwitch(),this.updBottom()})),s.appendChild(o),s.appendChild(n),s.appendChild(i),this.mode){case 1:d.appendChild(s);break;case 2:e.done||d.appendChild(s);break;case 3:e.done&&d.appendChild(s)}})),this.undone+this.done>0&&(this.displayBottom(),t.classList.add("show1"))}};e.addEventListener("keyup",(e=>{if("Enter"==e.key&&""!==e.target.value.trim()){const t=e.target.value.trim();e.target.value="",s.add(t),s.displaySwitch()}})),t.addEventListener("click",(()=>{s.undone+s.done>0&&(s.undone>0?(s.checkAll(),s.updBottom(),t.classList.remove("show1"),t.classList.add("show2")):(s.uncheckAll(),s.updBottom(),t.classList.remove("show2"),t.classList.add("show1")))}))})();